"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[2324],{3905:(e,t,r)=>{r.d(t,{Zo:()=>c,kt:()=>g});var n=r(7294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function o(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},l=Object.keys(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var i=n.createContext({}),u=function(e){var t=n.useContext(i),r=t;return e&&(r="function"==typeof e?e(t):s(s({},t),e)),r},c=function(e){var t=u(e.components);return n.createElement(i.Provider,{value:t},e.children)},p="mdxType",h={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,l=e.originalType,i=e.parentName,c=o(e,["components","mdxType","originalType","parentName"]),p=u(r),m=a,g=p["".concat(i,".").concat(m)]||p[m]||h[m]||l;return r?n.createElement(g,s(s({ref:t},c),{},{components:r})):n.createElement(g,s({ref:t},c))}));function g(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var l=r.length,s=new Array(l);s[0]=m;var o={};for(var i in t)hasOwnProperty.call(t,i)&&(o[i]=t[i]);o.originalType=e,o[p]="string"==typeof e?e:a,s[1]=o;for(var u=2;u<l;u++)s[u]=r[u];return n.createElement.apply(null,s)}return n.createElement.apply(null,r)}m.displayName="MDXCreateElement"},8164:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>i,contentTitle:()=>s,default:()=>p,frontMatter:()=>l,metadata:()=>o,toc:()=>u});var n=r(7462),a=(r(7294),r(3905));const l={slug:"change-ssh-port-in-linux-centos",title:"Change SSH Port in Linux CentOS (Oracle Linux 8)",authors:["jhasuraj01"],tags:["linux","ssh","firewalld","semanage"]},s="Change SSH Port in CentOS (Oracle Linux 8)",o={permalink:"/blog/change-ssh-port-in-linux-centos",editUrl:"https://github.com/jhasuraj01/blog/tree/main/blog/2022-12-08-change-ssh-port-in-linux-centos.mdx",source:"@site/blog/2022-12-08-change-ssh-port-in-linux-centos.mdx",title:"Change SSH Port in Linux CentOS (Oracle Linux 8)",description:"On Linux systems, the default SSH port is 22. There are a few reasons",date:"2022-12-08T00:00:00.000Z",formattedDate:"December 8, 2022",tags:[{label:"linux",permalink:"/blog/tags/linux"},{label:"ssh",permalink:"/blog/tags/ssh"},{label:"firewalld",permalink:"/blog/tags/firewalld"},{label:"semanage",permalink:"/blog/tags/semanage"}],readingTime:1.38,hasTruncateMarker:!0,authors:[{name:"Suraj Jha",title:"Educator @CodeChef | IT'24 | 4\u2b50 @CodeChef | Knight @Leetcode",url:"https://github.com/jhasuraj01",imageURL:"https://github.com/jhasuraj01.png",key:"jhasuraj01"}],frontMatter:{slug:"change-ssh-port-in-linux-centos",title:"Change SSH Port in Linux CentOS (Oracle Linux 8)",authors:["jhasuraj01"],tags:["linux","ssh","firewalld","semanage"]},prevItem:{title:"1143. Longest Common Subsequence, LeetCode",permalink:"/blog/leetcode/longest-common-subsequence"},nextItem:{title:"Ethereum Blockchain local environment setup using Ganache and truffle",permalink:"/blog/ethereum-blockchain-local-environment"}},i={authorsImageUrls:[void 0]},u=[{value:"Prerequisite",id:"prerequisite",level:2},{value:"Setup VM Firewall",id:"setup-vm-firewall",level:2},{value:"SSH Configuration",id:"ssh-configuration",level:2},{value:"Testing",id:"testing",level:2},{value:"References",id:"references",level:2}],c={toc:u};function p(e){let{components:t,...r}=e;return(0,a.kt)("wrapper",(0,n.Z)({},c,r,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"On Linux systems, the default SSH port is 22. There are a few reasons\nwhy you might want to change this number. This article will walk you\nthrough the process of changing the default ssh port 22 to 8080."),(0,a.kt)("h2",{id:"prerequisite"},"Prerequisite"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"If you are using oracle cloud, open port 8080 in Oracle Cloud Security list for SSH Access.")),(0,a.kt)("h2",{id:"setup-vm-firewall"},"Setup VM Firewall"),(0,a.kt)("p",null,"Check firewall state"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"sudo firewall-cmd --state\n")),(0,a.kt)("p",null,"Login as root user"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"sudo su root\n")),(0,a.kt)("p",null,"Update Port 22 to 8080"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"vi /usr/lib/firewalld/services/ssh.xml\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-output",metastring:"title='~/usr/lib/firewalld/services/ssh.xml'",title:"'~/usr/lib/firewalld/services/ssh.xml'"},'<?xml version="1.0" encoding="utf-8"?>\n<service>\n  <short>SSH</short>\n  <description>Secure Shell (SSH) is a protocol ... to be useful.</description>\n  \x3c!-- highlight-next-line --\x3e\n  <port protocol="tcp" port="8080"/>\n</service>\n')),(0,a.kt)("p",null,"Reload firewall and network"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"cp /usr/lib/firewalld/services/ssh.xml /etc/firewalld/services/ssh.xml\nfirewall-cmd --reload\nsystemctl restart network\nsystemctl reload firewalld\n")),(0,a.kt)("h2",{id:"ssh-configuration"},"SSH Configuration"),(0,a.kt)("p",null,"Set port 8080 as ssh port"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"semanage port -m -t ssh_port_t -p tcp 8080\n")),(0,a.kt)("p",null,"Update ssh port 22 to 8080"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"vi /etc/ssh/sshd_config\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-output",metastring:"title='~/etc/ssh/sshd_config'",title:"'~/etc/ssh/sshd_config'"},"...\n# If you want to change the port on a SELinux system, you have to tell\n# SELinux about this change.\n# semanage port -a -t ssh_port_t -p tcp #PORTNUMBER\n# highlight-next-line\nPort 8080\n#AddressFamily any\n#ListenAddress 0.0.0.0\n#ListenAddress ::\n\nHostKey /etc/ssh/ssh_host_rsa_key\n...\n")),(0,a.kt)("p",null,"Restart ssh daemon"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"systemctl restart sshd\n")),(0,a.kt)("h2",{id:"testing"},"Testing"),(0,a.kt)("p",null,"Open another terminal and try to ssh through new port"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},'ssh -i "PATH_TO_SSH_KEY" -p 8080 USERNAME@IP_ADDRESS -p 8080\n')),(0,a.kt)("h2",{id:"references"},"References"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://www.digitalocean.com/community/tutorials/how-to-set-up-a-firewall-using-firewalld-on-centos-7"},"How to set up a firewall using firewalld on centos 7")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://www.ionos.com/help/server-cloud-infrastructure/getting-started/important-security-information-for-your-server/changing-the-default-ssh-port/"},"Changing the default ssh port")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://serverfault.com/questions/834195/ssh-fails-after-port-change-on-centos-7"},"SSH fails after port change on centos 7")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://serverfault.com/questions/790404/selinux-error-valueerror-port-tcp-5000-already-defined"},"Selinux error valueerror port tcp 5000 already defined"))))}p.isMDXComponent=!0}}]);